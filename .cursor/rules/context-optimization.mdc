---
description: Рекомендации по оптимизации контекстного окна для длинных сессий
alwaysApply: true
---

# Оптимизация контекста

## Чтение файлов

- **Не читать большие файлы целиком** — использовать `offset`/`limit`
- **movies.ts** содержит 150+ фильмов — при работе с ним искать конкретные фильмы через grep
- Группировать связанные Read операции в один запрос

## Редактирование

- Использовать `StrReplace` вместо полной перезаписи файлов
- Указывать минимальный уникальный `old_string`

## Исследование кодовой базы

- Для вопросов "как работает X" использовать Task с `subagent_type="explore"`
- Экономит контекст главного чата

## Структура проекта

```
src/client/     — React UI (game/App.tsx, hooks/)
src/server/     — Express API (index.ts)
src/shared/     — Общие типы и данные (movies.ts, types/)
```

## Ключевые файлы

| Файл | Назначение |
|------|------------|
| `src/client/game/App.tsx` | Главный UI компонент игры |
| `src/client/hooks/useGame.ts` | Хук игровой логики |
| `src/server/index.ts` | API endpoints |
| `src/shared/data/movies.ts` | База фильмов (не читать целиком!) |

## При смене контекста

Попросить summary перед закрытием чата.
